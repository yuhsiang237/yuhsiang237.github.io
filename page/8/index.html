<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>UM&#39;s Coding Note</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="I record my coding experience at this place">
<meta property="og:type" content="website">
<meta property="og:title" content="UM&#39;s Coding Note">
<meta property="og:url" content="https://yuhsiang237.github.io/page/8/index.html">
<meta property="og:site_name" content="UM&#39;s Coding Note">
<meta property="og:description" content="I record my coding experience at this place">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Yu Hsiang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="UM's Coding Note" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">UM&#39;s Coding Note</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I record my coding experience at this place🤙</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://yuhsiang237.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-C-MVC-回傳獨立頁面或整體頁面" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/12/27/C-MVC-%E5%9B%9E%E5%82%B3%E7%8D%A8%E7%AB%8B%E9%A0%81%E9%9D%A2%E6%88%96%E6%95%B4%E9%AB%94%E9%A0%81%E9%9D%A2/" class="article-date">
  <time class="dt-published" datetime="2021-12-27T12:20:46.000Z" itemprop="datePublished">2021-12-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Framework/AspNetCore-MVC/">AspNetCore MVC</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/12/27/C-MVC-%E5%9B%9E%E5%82%B3%E7%8D%A8%E7%AB%8B%E9%A0%81%E9%9D%A2%E6%88%96%E6%95%B4%E9%AB%94%E9%A0%81%E9%9D%A2/">[Day27] C# MVC 回傳獨立頁面或整體頁面 - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在此介紹如何讓某些頁面不套用原本預設的_Layout.cshtml。</p>
<p>如常見的登入頁面，常常是一個獨立畫面，這時只要回傳PartialView。<br><strong>UserController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public IActionResult SignIn()</span><br><span class="line">&#123;</span><br><span class="line">    return PartialView();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而預設會套用_Layout.cshtml的則是回傳View。<br><strong>HomeController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public IActionResult Hone()</span><br><span class="line">&#123;</span><br><span class="line">    return View();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h3><p>簡單介紹一下，此外如果要控制預設吃什麼Layout可以從以下檔案設定:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\Views\_ViewStart.cshtml</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/12/27/C-MVC-%E5%9B%9E%E5%82%B3%E7%8D%A8%E7%AB%8B%E9%A0%81%E9%9D%A2%E6%88%96%E6%95%B4%E9%AB%94%E9%A0%81%E9%9D%A2/" data-id="cme6kwo0p001lgaljccwd5pmi" data-title="[Day27] C# MVC 回傳獨立頁面或整體頁面 - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C-MVC-LINQ實作常見用法" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/12/27/C-MVC-LINQ%E5%AF%A6%E4%BD%9C%E5%B8%B8%E8%A6%8B%E7%94%A8%E6%B3%95/" class="article-date">
  <time class="dt-published" datetime="2021-12-27T11:20:46.000Z" itemprop="datePublished">2021-12-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Framework/AspNetCore-MVC/">AspNetCore MVC</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/12/27/C-MVC-LINQ%E5%AF%A6%E4%BD%9C%E5%B8%B8%E8%A6%8B%E7%94%A8%E6%B3%95/">[Day26] C# MVC LINQ實作常見用法 - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在這篇中主要紀錄一些常見的C# LINQ寫法，通常搭配資料庫EF Core使用。</p>
<p>1.簡單取得匹配某ID的”複數”筆資料列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var query = </span><br><span class="line">from a in _context.Roles</span><br><span class="line">where a.Id == user.RoleId</span><br><span class="line">select a;</span><br></pre></td></tr></table></figure>

<p>2.取得某”單筆”物件資料</p>
<p>作法1:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var query = (from a in _context.Users</span><br><span class="line">where a.Account == userAccount</span><br><span class="line">select new</span><br><span class="line">&#123;</span><br><span class="line">    Id = a.Id,</span><br><span class="line">    Account = a.Account,</span><br><span class="line">    RoleId = a.RoleId,</span><br><span class="line">    Name = a.Name,</span><br><span class="line">    Email = a.Email</span><br><span class="line">&#125;).FirstOrDefault()</span><br></pre></td></tr></table></figure>
<p>作法2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var query =  _context.Products.FirstOrDefault(x =&gt; x.Id == shipmentOrderDetail.ProductId);</span><br></pre></td></tr></table></figure>

<p>差別在一個全是用.的方式寫。</p>
<p>3.群組資料結果。此例將日期變成群組，統計每日期具有的資料筆數。<br>且使用匿名class建立搜尋結果。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var query = from a in _context.ShipmentOrders</span><br><span class="line">where a.IsDeleted != true</span><br><span class="line">where a.DeliveryDate.Value.Month == DateTime.Now.Month</span><br><span class="line">group a by a.DeliveryDate.Value.Date into g</span><br><span class="line">select new &#123; DeliveryDate = g.Key, Count = g.Count() &#125;</span><br></pre></td></tr></table></figure>

<p>4.主表a之後inner join b表的資料。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var query = from a in _context.ReturnShipmentOrders</span><br><span class="line">join b in _context.ShipmentOrders</span><br><span class="line">on a.ShipmentOrderId equals b.Id</span><br><span class="line">where a.IsDeleted != true</span><br><span class="line">select new ReturnShipmentOrderViewModel</span><br><span class="line">&#123;</span><br><span class="line">Id = a.Id,</span><br><span class="line">Number = a.Number,</span><br><span class="line">ShipmentOrderNumber = b.Number,</span><br><span class="line">Total = a.Total,</span><br><span class="line">ReturnDate = a.ReturnDate</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>5.LINQ子查詢，Category表資料在另一個多對多表上，使用子查詢去取得結果。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var query = from a in _context.Products</span><br><span class="line">where a.IsDeleted != true</span><br><span class="line">select new ProductIndexViewModel</span><br><span class="line">&#123;</span><br><span class="line">    Id = a.Id,</span><br><span class="line">    Number = a.Number,</span><br><span class="line">    Name = a.Name,</span><br><span class="line">    CurrentUnit = a.CurrentUnit,</span><br><span class="line">    Price = a.Price,</span><br><span class="line">    Description = a.Description,</span><br><span class="line">    Category = (from b in _context.ProductProductCategoryRelationships</span><br><span class="line">                    join c in category</span><br><span class="line">                    on b.ProductCategoryId equals c.Id</span><br><span class="line">                    where b.ProductId == a.Id</span><br><span class="line">                    select new ProductCategory</span><br><span class="line">                    &#123; </span><br><span class="line">                        Id = c.Id,</span><br><span class="line">                        Name = c.Name</span><br><span class="line">                    &#125;).ToList()</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>6.取得總數統計，在此例以取得某年的Total加總。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var query = (from a in _context.ShipmentOrders</span><br><span class="line">where a.IsDeleted != true</span><br><span class="line">where a.FinishDate.Value.Year == DateTime.Now.Year</span><br><span class="line">select a.Total).Sum()</span><br></pre></td></tr></table></figure>

<p>7.取得查詢的結果數量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var query = (int)(from a in _context.Products</span><br><span class="line">where a.IsDeleted != true</span><br><span class="line">select a.Id).Count();</span><br></pre></td></tr></table></figure>

<h3 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h3><p>主要在這篇中紀錄實作常見會寫到的作法。<br>此外，如果熟悉LINQ後反而會造成原生SQL語法淡忘，所以還是要加減注意一下原生作法。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/12/27/C-MVC-LINQ%E5%AF%A6%E4%BD%9C%E5%B8%B8%E8%A6%8B%E7%94%A8%E6%B3%95/" data-id="cme6kwo0f0012galjg3vga3au" data-title="[Day26] C# MVC LINQ實作常見用法 - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Arduino-LED與Button控制" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/" class="article-date">
  <time class="dt-published" datetime="2021-10-29T09:04:44.000Z" itemprop="datePublished">2021-10-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Computer-Science/">Computer Science</a>►<a class="article-category-link" href="/categories/Computer-Science/Electronic-Circuit/">Electronic Circuit</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/">Arduino LED與Button控制</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>想以僅有的材料做個LED與按鈕控制實驗。<br>並且藉由撰寫程式來監控按鈕，並控制LED明暗。</p>
<h3 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h3><ol>
<li>LED 3MM 紅色 x 1 :發光二極體 (1.8V～2.2V，5mA～20mA)</li>
<li>Arduino版  x 1:任意一塊都可 (UNO)</li>
<li>220歐姆電阻(5%)  x 1:紅紅棕金</li>
<li>2.2k歐姆電阻(5%)  x 5:紅紅紅金</li>
</ol>
<p>首先是LED的線路，要讓LED能夠穩定且不燒壞的亮燈，要先計算電阻多少。<br>OUTPUT會給予5V，因此用歐姆定律</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V = IR</span><br></pre></td></tr></table></figure>
<p>(5-2)=0.02R<br>R=150ohm</p>
<p>但是LED其實可以低於20mA，規格是5mA～20mA<br>因此嘗試串聯一顆220歐姆電阻算看看:<br>(5-2)=I*220<br>I=3/220<br>=0.013A<br>=13mA<br>還在範圍內!所以就用220歐姆電阻了!</p>
<p>再來是按鈕部分，這時要扯到一個新概念就是上拉電阻<br>上拉電阻:<br>在數位電路中，上拉電阻（英語：Pull-up resistors）是當某輸入埠未連接設備或處於高阻抗的情況下，一種用於保證輸入訊號為預期邏輯電平的電阻元件。他們通常在不同的邏輯裝置之間工作，提供一定的電壓訊號。</p>
<p>主要用上拉電阻協助我們按鈕提供穩定的訊號。</p>
<img src="/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/Pullup_Resistor.png" class="">
<p>當開關斷開的時候，邏輯閘的輸入訊號被上拉到Vin；當開關閉合的時候，邏輯閘的輸入端與地面相連，輸入訊號接近0伏特。</p>
<p>通常上拉電阻都會接10K電阻，但我手邊只有2.2k所以串個5顆。</p>
<p>V=IR<br>5 = I*(2200*5)<br>I=0.0004A=0.4mA</p>
<img src="/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/LEDWithButton_%E6%9E%B6%E6%A7%8B%E5%9C%96.png" class="">

<img src="/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/LEDWithButton_bb.png" class="">


<p><strong>Code.ino</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const int BUTTON_PIN = 7;  // 按鍵的接腳</span><br><span class="line">const int LED_PIN =  8;   // LED燈的接腳</span><br><span class="line"></span><br><span class="line">int buttonState = 0;   // 按鈕的狀態</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">  Serial.begin(115200);</span><br><span class="line">  pinMode(LED_PIN, OUTPUT);   //設定LED的PIN腳為輸出</span><br><span class="line">  pinMode(BUTTON_PIN, INPUT); //設定按鈕的接腳為輸入，因為我們要讀取它的狀態</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line">  buttonState = digitalRead(BUTTON_PIN);  //讀取按鍵的狀態</span><br><span class="line"> </span><br><span class="line">  if(buttonState == LOW)&#123;          //如果按鍵按了</span><br><span class="line">    Serial.print(buttonState);</span><br><span class="line">    digitalWrite(LED_PIN, HIGH);   //LED就亮了 </span><br><span class="line">  &#125;else&#123;                           //如果按鍵是未按下</span><br><span class="line">    Serial.print(buttonState);</span><br><span class="line">    digitalWrite(LED_PIN, LOW);    //LED就不亮</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/Screen%20Shot%202021-10-19%20at%2011.02.02%20PM.png" class="">

<img src="/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/demo.gif" class="">


<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>發現電路需要理論部分的加強，否則接出來的線路會有問題。<br>以此來說就是上拉電阻，如果不知道他的原理，會覺得接個5V出來是要做什麼。</p>
<p><strong>參考資料</strong><br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%8A%E6%8B%89%E7%94%B5%E9%98%BB">https://zh.wikipedia.org/wiki/%E4%B8%8A%E6%8B%89%E7%94%B5%E9%98%BB</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/29/Arduino-LED%E8%88%87Button%E6%8E%A7%E5%88%B6/" data-id="cme6kwnzu0006galj54il14h6" data-title="Arduino LED與Button控制" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C-MVC-API-Bearer-Token實作" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/" class="article-date">
  <time class="dt-published" datetime="2021-10-28T13:57:47.000Z" itemprop="datePublished">2021-10-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Framework/AspNetCore-API/">AspNetCore API</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/">[Day25] C# MVC API JWT Token驗證 (下) JWT實作 - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在這篇中主要實作JWT的登入認證，取得Token、透過Token對有權限的API進行存取。</p>
<h3 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h3><p>1.先安裝JWT套件，因為我是用AspNetCore所以用<br>Microsoft.AspNetCore.Authentication.JwtBearer</p>
<img src="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/1.png" class="">

<h3 id="撰寫"><a href="#撰寫" class="headerlink" title="撰寫"></a>撰寫</h3><p>1.撰寫產生JWT Token的程式碼。<br><strong>TokenController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[HttpPost(&quot;GenerateToken&quot;)]</span><br><span class="line">[AllowAnonymous]</span><br><span class="line">public ActionResult&lt;string&gt; GenerateToken()</span><br><span class="line">&#123;</span><br><span class="line">    string issuer = &quot;JwtAuthDemo&quot;;</span><br><span class="line">    string signKey = &quot;ASASA1@AAASASASASA1@AAASAS&quot;; // 需要大於16字元</span><br><span class="line">    string Account = &quot;TestAccount&quot;;</span><br><span class="line">  </span><br><span class="line">    var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(signKey));</span><br><span class="line">    var signingCredentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256Signature);</span><br><span class="line"></span><br><span class="line">    // 建立 SecurityTokenDescriptor</span><br><span class="line">    var tokenDescriptor = new SecurityTokenDescriptor</span><br><span class="line">    &#123;</span><br><span class="line">        Issuer = issuer,</span><br><span class="line">        Subject = new ClaimsIdentity(new[]</span><br><span class="line">                &#123;</span><br><span class="line">                  new Claim(JwtRegisteredClaimNames.Sub, Account), // User.Identity.Name</span><br><span class="line">                  new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString()), // JWT ID</span><br><span class="line">                  new Claim(&quot;test&quot;, &quot;123&quot;) // 可加入自訂內容在聲明裡</span><br><span class="line">                &#125;),</span><br><span class="line">        Expires = DateTime.Now.AddMinutes(60),</span><br><span class="line">        SigningCredentials = signingCredentials</span><br><span class="line">    &#125;;</span><br><span class="line">    var tokenHandler = new JwtSecurityTokenHandler();</span><br><span class="line">    var securityToken = tokenHandler.CreateToken(tokenDescriptor);</span><br><span class="line">    var serializeToken = tokenHandler.WriteToken(securityToken);</span><br><span class="line">    return serializeToken;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.撰寫測試JWT請求的程式碼<br>在此撰寫兩個一個是取得所有聲明，一個是取得該Token得獨立識別值。<br><strong>TokenController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[Authorize]</span><br><span class="line">[HttpGet(&quot;GetClaims&quot;)]</span><br><span class="line">public IActionResult GetClaims()</span><br><span class="line">&#123;</span><br><span class="line">    return Ok(User.Claims.Select(p =&gt; new &#123; p.Type, p.Value &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[Authorize]</span><br><span class="line">[HttpGet(&quot;GetTokenID&quot;)]</span><br><span class="line">public IActionResult GetTokenID()</span><br><span class="line">&#123;</span><br><span class="line">    var jti = User.Claims.FirstOrDefault(p =&gt; p.Type == &quot;jti&quot;);//每個token的識別值，如果要禁用某token就可以把識別值存到資料庫當黑名單</span><br><span class="line">    return Ok(jti.Value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3.增加服務<br>Startup.cs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public void ConfigureServices(IServiceCollection services)&#123;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  services</span><br><span class="line">  .AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span><br><span class="line">  .AddJwtBearer(options =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">  // 當驗證失敗時，回應標頭會包含 WWW-Authenticate 標頭，這裡會顯示失敗的詳細錯誤原因</span><br><span class="line">  options.IncludeErrorDetails = true; // 預設值為 true，有時會特別關閉</span><br><span class="line"></span><br><span class="line">  options.TokenValidationParameters = new TokenValidationParameters</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    // 一般我們都會驗證 Issuer</span><br><span class="line">    ValidateIssuer = true,</span><br><span class="line">    ValidIssuer = &quot;JwtAuthDemo&quot;,</span><br><span class="line"></span><br><span class="line">    // 通常不太需要驗證 Audience</span><br><span class="line">    ValidateAudience = false,</span><br><span class="line">    //ValidAudience = &quot;JwtAuthDemo&quot;, // 不驗證就不需要填寫</span><br><span class="line"></span><br><span class="line">    // 一般我們都會驗證 Token 的有效期間</span><br><span class="line">    ValidateLifetime = true,</span><br><span class="line"></span><br><span class="line">    // 如果 Token 中包含 key 才需要驗證，一般都只有簽章而已</span><br><span class="line">    ValidateIssuerSigningKey = false,</span><br><span class="line"></span><br><span class="line">    // JWT簽證密要，之後可自行設定在appsettings.json</span><br><span class="line">    IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(&quot;ASASA1@AAASASASASA1@AAASAS&quot;))</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4.添加授權</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public void Configure(IApplicationBuilder app, IWebHostEnvironment env, IApiVersionDescriptionProvider provider)</span><br><span class="line">&#123;</span><br><span class="line">        app.UseAuthentication(); </span><br><span class="line">        app.UseAuthorization();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5.完成測試結果:<br>取得Token</p>
<img src="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/2.png" class="">
<p>用剛剛產生的JWT Token取得聲明</p>
<img src="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/3.png" class="">
<p>用剛剛產生的JWT Token取得Token識別值</p>
<img src="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/4.png" class="">


<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>C#在處理JWT上算是蠻簡潔的，不用寫太多行，主要複雜點就在Startup.cs增加服務、產生Token這兩個步驟。<br>專案存庫位置:<a target="_blank" rel="noopener" href="https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI-JWT">https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI-JWT</a></p>
<p>然後附上DEMO影片一個是用Postman測試，一個是程式碼跑起的時的Swagger<br>swagger demo:</p>
<img src="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/demo.gif" class="">
<p>postman demo:</p>
<img src="/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/postmandemo.gif" class="">



      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/28/C-MVC-API-Bearer-Token%E5%AF%A6%E4%BD%9C/" data-id="cme6kwo08000qgalj1p42cx2z" data-title="[Day25] C# MVC API JWT Token驗證 (下) JWT實作 - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Arduino-LED亮燈" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/28/Arduino-LED%E4%BA%AE%E7%87%88/" class="article-date">
  <time class="dt-published" datetime="2021-10-28T09:04:44.000Z" itemprop="datePublished">2021-10-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Computer-Science/">Computer Science</a>►<a class="article-category-link" href="/categories/Computer-Science/Electronic-Circuit/">Electronic Circuit</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/28/Arduino-LED%E4%BA%AE%E7%87%88/">Arduino限流LED實驗</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>想以僅有的材料做個LED限流的實驗，並使用電路公式算出理論數值實作。</p>
<h3 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h3><ol>
<li>LED 3MM 紅色 x 1 :發光二極體</li>
<li>Arduino版  x 1:任意一塊都可</li>
<li>220歐姆電阻  x 3:紅紅棕金</li>
</ol>
<h3 id="理論部分"><a href="#理論部分" class="headerlink" title="理論部分"></a>理論部分</h3><p>首先我們Arduino電源接3.3V，而LED紅的電流需要0.02A(20mA)電壓則是2.0-2.2V，姑且算2.0電壓。</p>
<p>這時3.3V怎樣降到2.0V?就是使用電阻<br>那要多少歐姆的電阻值呢?<br>透過歐姆定律<br>在電路學裏，歐姆定律（英語：Ohm’s law）表明，導電體兩端的電壓與通過導電體的電流成正比，以方程式表示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V=IR</span><br></pre></td></tr></table></figure>
<p>(3.3-2.0) = 0.02 * R<br>1.3 = 0.02R<br>R = 1.3/0.02<br>R = 65<br>所以我們需要65Ω(Ohm)的電阻<br>但天殺的= =肯定不會這麼剛好有65歐姆的電阻，這時就要用現有的電阻兜出來。<br>並聯電阻可以降低歐姆。<br>依照克希荷夫電路定律推倒後得到以下公式:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rt = 1/(1/R1+1/R2+1/R3+...+1/Rn)</span><br></pre></td></tr></table></figure>
<p>以現有的220歐姆電阻要降到65就要稍微計算一下</p>
<p>3顆:<br>1/(1/220+1/220+1/220) = 73<br>4顆:<br>1/(1/220+1/220+1/220+1/220) = 55</p>
<p>發現3顆電阻約可以到73很接近65了，第4顆則是會低過65。<br>我們使用電阻是為了降低電壓、限流，讓IC能夠正常啟用下避免過熱燒毀、穩定運作，所以差不多就使用3顆電阻並聯。</p>
<p>電路圖</p>
<img src="/2021/10/28/Arduino-LED%E4%BA%AE%E7%87%88/%E9%9B%BB%E8%B7%AF%E5%9C%96_fx.png" class="">

<p>接線圖</p>
<img src="/2021/10/28/Arduino-LED%E4%BA%AE%E7%87%88/%E5%AF%A6%E9%9A%9B%E6%8E%A5%E7%B7%9A%E5%9C%96_fx.png" class="">

<p>現實:</p>
<img src="/2021/10/28/Arduino-LED%E4%BA%AE%E7%87%88/real_fx.png" class="">

<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>用理論公式推後就可以用任意的電壓、電阻來兜<br>避免IC燒壞、延長使用時間</p>
<p>((ps.懂了後會覺得一些範例書上只給一個電阻然後不告訴你為什麼、怎麼算實在太黑了。</p>
<p><strong>參考資料</strong><br>電阻色碼計算<br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%9B%BB%E9%98%BB%E8%89%B2%E7%A2%BC">https://zh.wikipedia.org/wiki/%E9%9B%BB%E9%98%BB%E8%89%B2%E7%A2%BC</a><br>電阻放置<br><a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/1610875004126323107.html">https://zhidao.baidu.com/question/1610875004126323107.html</a><br>限流電阻計算器<br><a target="_blank" rel="noopener" href="https://gc.digitw.com/Program/Resistor4LED/Resistor4LED.htm">https://gc.digitw.com/Program/Resistor4LED/Resistor4LED.htm</a><br>為什麼LED要加上電阻<br><a target="_blank" rel="noopener" href="http://yehnan.blogspot.com/2012/03/arduinoled220-ohm.html">http://yehnan.blogspot.com/2012/03/arduinoled220-ohm.html</a><br>控制LED<br><a target="_blank" rel="noopener" href="https://blog.jmaker.com.tw/arduino-tutorials-3/">https://blog.jmaker.com.tw/arduino-tutorials-3/</a><br>歐姆定律<br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%A7%86%E5%AE%9A%E5%BE%8B">https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%A7%86%E5%AE%9A%E5%BE%8B</a><br>並聯電路<br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%A6%E8%81%AF%E9%9B%BB%E8%B7%AF#%E9%9B%BB%E9%98%BB%E5%99%A8">https://zh.wikipedia.org/wiki/%E4%B8%A6%E8%81%AF%E9%9B%BB%E8%B7%AF#%E9%9B%BB%E9%98%BB%E5%99%A8</a><br>克希荷夫電路定律<br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%9F%BA%E7%88%BE%E9%9C%8D%E5%A4%AB%E9%9B%BB%E8%B7%AF%E5%AE%9A%E5%BE%8B#%E5%9F%BA%E7%88%BE%E9%9C%8D%E5%A4%AB%E9%9B%BB%E6%B5%81%E5%AE%9A%E5%BE%8B%EF%BC%88KCL%EF%BC%89">https://zh.wikipedia.org/wiki/%E5%9F%BA%E7%88%BE%E9%9C%8D%E5%A4%AB%E9%9B%BB%E8%B7%AF%E5%AE%9A%E5%BE%8B#%E5%9F%BA%E7%88%BE%E9%9C%8D%E5%A4%AB%E9%9B%BB%E6%B5%81%E5%AE%9A%E5%BE%8B%EF%BC%88KCL%EF%BC%89</a><br>歐姆定律<br><a target="_blank" rel="noopener" href="https://physcourse.thu.edu.tw/mengwen/%E6%99%AE%E7%89%A9%E5%AF%A6%E9%A9%97/%E5%AF%A6%E9%A9%97%E9%A0%85%E7%9B%AE/%E6%AD%90%E5%A7%86%E5%AE%9A%E5%BE%8B/">https://physcourse.thu.edu.tw/mengwen/%E6%99%AE%E7%89%A9%E5%AF%A6%E9%A9%97/%E5%AF%A6%E9%A9%97%E9%A0%85%E7%9B%AE/%E6%AD%90%E5%A7%86%E5%AE%9A%E5%BE%8B/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/28/Arduino-LED%E4%BA%AE%E7%87%88/" data-id="cme6kwnzt0005galj0n4z4n80" data-title="Arduino限流LED實驗" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C-MVC-API-Bearer-Token驗證" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/27/C-MVC-API-Bearer-Token%E9%A9%97%E8%AD%89/" class="article-date">
  <time class="dt-published" datetime="2021-10-27T13:57:47.000Z" itemprop="datePublished">2021-10-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Framework/AspNetCore-API/">AspNetCore API</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/27/C-MVC-API-Bearer-Token%E9%A9%97%E8%AD%89/">[Day24] C# MVC API JWT Token驗證 (上) JWT基礎知識 - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在先前有介紹過Cookie-Based驗證於MVC專案裡。</p>
<a href="/2021/10/07/C-MVC-%E9%A9%97%E8%AD%89%E8%88%87%E6%8E%88%E6%AC%8A%E7%99%BB%E5%85%A5%E8%88%87%E7%99%BB%E5%87%BA/" title="[Day12] C# MVC 驗證與授權，登入與登出 - C#&amp;AspNetCore">[Day12] C# MVC 驗證與授權，登入與登出 - C#&amp;AspNetCore</a>

<p>而這回主要探討的是Token-Based驗證，也就是API常用的JWT (Json Web Token)。</p>
<h3 id="什麼是JWT"><a href="#什麼是JWT" class="headerlink" title="什麼是JWT"></a>什麼是JWT</h3><p>JSON Web Token (JWT) is a proposed Internet standard for creating data with optional signature and/or optional encryption whose payload holds JSON that asserts some number of claims. </p>
<p>為JSON Web Token，是一個建議的網路標準，用來建立簽名，且在其中可以視需求加入自訂的JSON內容。</p>
<p>簡言之，就是令牌(Token)，你可以拿這令牌去要資料。</p>
<h3 id="JWT優點"><a href="#JWT優點" class="headerlink" title="JWT優點"></a>JWT優點</h3><p>跨域: 不受網域限制，可用來串接第三方應用，如 OAuth。<br>安全性: 不使用 Cookie 因此不會受到 CSRF 攻擊，不過 Token 並不能防護 XSS 攻擊，還是需要特別注意。<br>行動端: 可用於不支援 Cookie 的裝置上，且現在網站和 APP 串接普遍使用 Token 授權。</p>
<h3 id="JWT格式"><a href="#JWT格式" class="headerlink" title="JWT格式"></a>JWT格式</h3><p>主要由三個部分組成:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header.payload.signature</span><br></pre></td></tr></table></figure>


<p><strong>Header</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>alg:定義加密的方式產生signature，如上是HS256表示使用是HMAC-SHA256.<br>typ:Token類型</p>
<p>常被使用的header如:typ、cty、alg、kid、x5c、x5u、crit<br>可自行添加參考:<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JSON_Web_Token">https://en.wikipedia.org/wiki/JSON_Web_Token</a></p>
<p><strong>Payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;loggedInAs&quot;: &quot;admin&quot;,</span><br><span class="line">  &quot;iat&quot;: 1422779638</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>loggedInAs:這是客製化claim，以此來說是管理員。<br>iat:這是標準的claim，表示此JWT發布的時間。</p>
<p>標準的claim如:iss、sub、aud、exp、nbf、iat、jti<br>可自行添加參考:<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JSON_Web_Token">https://en.wikipedia.org/wiki/JSON_Web_Token</a></p>
<p>通常為了讓前端或後端好存取多加上一些識別值。</p>
<p><strong>Signature</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HMAC_SHA256(</span><br><span class="line">  secret,</span><br><span class="line">  base64urlEncoding(header) + &#x27;.&#x27; +</span><br><span class="line">  base64urlEncoding(payload)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>簽名，確保資料完整性的雜湊簽章。</p>
<p>將以上三者用Base64url Encoding結果即為JWT</p>
<p>生成:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const token = base64urlEncoding(header) + &#x27;.&#x27; + base64urlEncoding(payload) + &#x27;.&#x27; + base64urlEncoding(signature)</span><br></pre></td></tr></table></figure>
<p>結果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dnZWRJbkFzIjoiYWRtaW4iLCJpYXQiOjE0MjI3Nzk2Mzh9.gzSraSYS8EXBxLN_oWnFSRgCzcmJmMjLiuyu5CSpyHI</span><br></pre></td></tr></table></figure>

<h3 id="使用情境"><a href="#使用情境" class="headerlink" title="使用情境"></a>使用情境</h3><p>將此Token放置於API請求的Header中:<br>例如:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dnZWRJbkFzIjoiYWRtaW4iLCJpYXQiOjE0MjI3Nzk2Mzh9.gzSraSYS8EXBxLN_oWnFSRgCzcmJmMjLiuyu5CSpyHI</span><br></pre></td></tr></table></figure>
<p>傳送給後端</p>
<h3 id="JWT衍伸問題"><a href="#JWT衍伸問題" class="headerlink" title="JWT衍伸問題"></a>JWT衍伸問題</h3><p>Token的竊取問題，因為JWT發出去就不能銷毀，只能自己等待過期。<br>所以有了<code>Refresh Token</code>的出現。</p>
<p>使用Refresh Token後:<br>縮短每個Token時間，過期時再重新索取。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;access_token&quot;:&quot;l0XG52TQx&quot;,    //Token</span><br><span class="line">  &quot;refresh_token&quot;:&quot;KWI3JOkFA&quot;,   //Refresh Token</span><br><span class="line">  &quot;expires_in&quot;:3600              //幾秒過期</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>當Token過期後，使用refresh_token呼叫一個API要取一個新Token。<br>refresh_token是存在自己資料庫內的，所以被盜用可以馬上刪除掉!</p>
<p>在寫程式碼時可以在某API發現過期後立即呼叫更換。<br>或是用Token裡面帶入的payload去確認更換時機也可以，但可能會有時區問題。</p>
<p>此外，如果用Refresh Token仍會有一些安全疑慮，就是發出的token還是要等到時間自己逾期。<br>(不如自己建表記Token還比較安全，所以在下面我寫了額外補充)</p>
<h3 id="額外補充"><a href="#額外補充" class="headerlink" title="額外補充"></a>額外補充</h3><p>除了JWT外也有一些自訂的做法能用來驗證APP手機端。<br>如DB自建Token表，可能像是這樣:</p>
<p>每次操作API都帶入Token，DB檢驗一次。<br>被盜用時想刪隨時能刪、能強制登出。</p>
<p><strong>Tokens資料表</strong></p>
<table>
<tr>
<th>UserID</th>
<th>Token</th>
<th>Expires_In</th>
</tr>
<tr>
<td>1</td>
<td>AJIASOIASssarJ</td>
<td>2021-10-16</td>
</tr>
<tr>
<td>2</td>
<td>AASKOPASKOAPaS</td>
<td>2021-10-17</td>
</tr>
<tr>
<td>3</td>
<td>AASK45as4daaS</td>
<td>2021-10-14</td>
</tr>
</table>

<p>流程大概像這樣:<br>API&gt;撈DB檢查&gt;大於時間，刪除Token&gt;回傳授權失敗</p>
<p>雖然比較耗資料庫資源但我覺得是最安全的方式XD。<br>而且沒有發出要等到時間到才會逾期的問題</p>
<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>在這回中主要探討JWT是什麼、前置的知識理論。<br>發現了JWT的一些好處與壞處。</p>
<p>因此如果有疑慮好像自己建立Token表還是最安全的XD</p>
<p>而在下篇中將會實作JWT的機制。</p>
<p><strong>參考資料</strong><br><a target="_blank" rel="noopener" href="https://ithelp.ithome.com.tw/articles/10199102">https://ithelp.ithome.com.tw/articles/10199102</a><br><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/JSON_Web_Token">https://en.wikipedia.org/wiki/JSON_Web_Token</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/27/C-MVC-API-Bearer-Token%E9%A9%97%E8%AD%89/" data-id="cme6kwo07000ngalja1kjdumx" data-title="[Day24] C# MVC API JWT Token驗證 (上) JWT基礎知識 - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C-MVC-Web-API增加Swagger" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/26/C-MVC-Web-API%E5%A2%9E%E5%8A%A0Swagger/" class="article-date">
  <time class="dt-published" datetime="2021-10-26T11:59:32.000Z" itemprop="datePublished">2021-10-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/26/C-MVC-Web-API%E5%A2%9E%E5%8A%A0Swagger/">[Day23] C# MVC Web API版本增加Swagger - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在上回中我們介紹了 <a href="/2021/10/19/C-MVC-API%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" title="[Day22] C# MVC API版本控制 - C#&amp;AspNetCore">[Day22] C# MVC API版本控制 - C#&amp;AspNetCore</a> ，實作了RESTful API的版控。</p>
<p>而這回將要進行API的部屬，使用Swagger UI。</p>
<p>找了很多篇算是找到一篇<br><a target="_blank" rel="noopener" href="https://codingfreaks.de/dotnet-core-api-versioning/">https://codingfreaks.de/dotnet-core-api-versioning/</a><br>可以同時使用API Versioning跟Swagger套件的範例</p>
<p>在這篇中主要配置API並且切版本</p>
<p>1.先用Nuget安裝以下套件:<br>Swashbuckle.AspNetCore<br>Swashbuckle.AspNetCore.Annotations<br>Swashbuckle.AspNetCore.Swagger<br>Swashbuckle.AspNetCore.SwaggerGen<br>Swashbuckle.AspNetCore.SwaggerUI</p>
<img src="/2021/10/26/C-MVC-Web-API%E5%A2%9E%E5%8A%A0Swagger/4.png" class="">

<p>2.再來是我們要修改的檔案</p>
<img src="/2021/10/26/C-MVC-Web-API%E5%A2%9E%E5%8A%A0Swagger/5.png" class="">

<p>首先是Swagger的定義類別</p>
<p><strong>~/ConfigureSwaggerOptions.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">namespace ApiVersioningSample</span><br><span class="line">&#123;</span><br><span class="line">    using System;</span><br><span class="line">    using System.Linq;</span><br><span class="line"></span><br><span class="line">    using Microsoft.AspNetCore.Mvc.ApiExplorer;</span><br><span class="line">    using Microsoft.Extensions.DependencyInjection;</span><br><span class="line">    using Microsoft.Extensions.Options;</span><br><span class="line">    using Microsoft.OpenApi.Models;</span><br><span class="line"></span><br><span class="line">    using Swashbuckle.AspNetCore.SwaggerGen;</span><br><span class="line"></span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// Configures the Swagger generation options.</span><br><span class="line">    /// &lt;/summary&gt;</span><br><span class="line">    /// &lt;remarks&gt;</span><br><span class="line">    /// &lt;para&gt;</span><br><span class="line">    /// This allows API versioning to define a Swagger document per API version after the</span><br><span class="line">    /// &lt;see cref=&quot;IApiVersionDescriptionProvider&quot; /&gt; service has been resolved from the service container.</span><br><span class="line">    /// &lt;/para&gt;</span><br><span class="line">    /// &lt;para&gt;Taken from https://github.com/microsoft/aspnet-api-versioning.&lt;/para&gt;</span><br><span class="line">    /// &lt;/remarks&gt;</span><br><span class="line">    public class ConfigureSwaggerOptions : IConfigureOptions&lt;SwaggerGenOptions&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        #region member vars</span><br><span class="line"></span><br><span class="line">        private readonly IApiVersionDescriptionProvider _provider;</span><br><span class="line"></span><br><span class="line">        #endregion</span><br><span class="line"></span><br><span class="line">        #region constructors and destructors</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Initializes a new instance of the &lt;see cref=&quot;ConfigureSwaggerOptions&quot; /&gt; class.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=&quot;provider&quot;&gt;</span><br><span class="line">        /// The &lt;see cref=&quot;IApiVersionDescriptionProvider&quot;&gt;provider&lt;/see&gt; used to generate Swagger</span><br><span class="line">        /// documents.</span><br><span class="line">        /// &lt;/param&gt;</span><br><span class="line">        public ConfigureSwaggerOptions(IApiVersionDescriptionProvider provider)</span><br><span class="line">        &#123;</span><br><span class="line">            _provider = provider;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #endregion</span><br><span class="line"></span><br><span class="line">        #region explicit interfaces</span><br><span class="line"></span><br><span class="line">        /// &lt;inheritdoc /&gt;</span><br><span class="line">        public void Configure(SwaggerGenOptions options)</span><br><span class="line">        &#123;</span><br><span class="line">            // add a swagger document for each discovered API version</span><br><span class="line">            // note: you might choose to skip or document deprecated API versions differently</span><br><span class="line">            foreach (var description in _provider.ApiVersionDescriptions)</span><br><span class="line">            &#123;</span><br><span class="line">                options.SwaggerDoc(description.GroupName, CreateInfoForApiVersion(description));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #endregion</span><br><span class="line"></span><br><span class="line">        #region methods</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Internal implementation for building the Swagger basic config.</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=&quot;description&quot;&gt;The description object containing the.&lt;/param&gt;</span><br><span class="line">        /// &lt;returns&gt;The generated Open API info.&lt;/returns&gt;</span><br><span class="line">        private static OpenApiInfo CreateInfoForApiVersion(ApiVersionDescription description)</span><br><span class="line">        &#123;</span><br><span class="line">            var info = new OpenApiInfo</span><br><span class="line">            &#123;</span><br><span class="line">                Title = &quot;Sample API&quot;,</span><br><span class="line">                Version = description.ApiVersion.ToString(),</span><br><span class="line">                Description = @&quot;&lt;p&gt;Sample API with versioning including Swagger.&lt;/p&gt;&lt;p&gt;Partly taken from &lt;a href=&quot;&quot;https://github.com/microsoft/aspnet-api-versioning&quot;&quot;&gt;this repository&lt;/a&gt;.&lt;/p&gt;&quot;,</span><br><span class="line">                Contact = new OpenApiContact</span><br><span class="line">                &#123;</span><br><span class="line">                    Name = &quot;Yu Hsiang&quot;,</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            if (description.IsDeprecated)</span><br><span class="line">            &#123;</span><br><span class="line">                info.Description += @&quot;&lt;p&gt;&lt;strong&gt;&lt;span style=&quot;&quot;color:white;background-color:red&quot;&quot;&gt;VERSION IS DEPRECATED&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            return info;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #endregion</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>這類別主要用來放Swagger客製化的數值</p>
<p>再來是啟用Swagger</p>
<p><strong>~/Startup.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">using Microsoft.AspNetCore.Builder;</span><br><span class="line">using Microsoft.AspNetCore.Hosting;</span><br><span class="line">using Microsoft.AspNetCore.HttpsPolicy;</span><br><span class="line">using Microsoft.AspNetCore.Mvc;</span><br><span class="line">using Microsoft.Extensions.Configuration;</span><br><span class="line">using Microsoft.Extensions.DependencyInjection;</span><br><span class="line">using Microsoft.Extensions.Hosting;</span><br><span class="line">using Microsoft.Extensions.Logging;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Threading.Tasks;</span><br><span class="line">using Microsoft.EntityFrameworkCore;</span><br><span class="line">using TodoAPI.Models;</span><br><span class="line">using Microsoft.OpenApi.Models;</span><br><span class="line">using Swashbuckle.AspNetCore.SwaggerGen;</span><br><span class="line">using Microsoft.Extensions.Options;</span><br><span class="line">using ApiVersioningSample;</span><br><span class="line">using Microsoft.AspNetCore.Mvc.ApiExplorer;</span><br><span class="line"></span><br><span class="line">namespace TodoAPI</span><br><span class="line">&#123;</span><br><span class="line">    public class Startup</span><br><span class="line">    &#123;</span><br><span class="line">        public Startup(IConfiguration configuration)</span><br><span class="line">        &#123;</span><br><span class="line">            Configuration = configuration;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public IConfiguration Configuration &#123; get; &#125;</span><br><span class="line"></span><br><span class="line">        // This method gets called by the runtime. Use this method to add services to the container.</span><br><span class="line">        public void ConfigureServices(IServiceCollection services)</span><br><span class="line">        &#123;</span><br><span class="line">            services.AddControllers();</span><br><span class="line">            // 資料庫配置</span><br><span class="line">            var connection = @&quot;Server=.\SQLExpress;Database=TodoDB;Trusted_Connection=True;ConnectRetryCount=0&quot;;</span><br><span class="line">            services.AddDbContext&lt;TodoDBContext&gt;(options =&gt; options.UseSqlServer(connection));</span><br><span class="line"></span><br><span class="line">            // 啟用API版控功能</span><br><span class="line">            services.AddApiVersioning(</span><br><span class="line">              options =&gt;</span><br><span class="line">              &#123;</span><br><span class="line">                    // reporting api versions will return the headers &quot;api-supported-versions&quot; and &quot;api-deprecated-versions&quot;</span><br><span class="line">                    options.ReportApiVersions = true;</span><br><span class="line">              &#125;);</span><br><span class="line"></span><br><span class="line">            // swagger 配置</span><br><span class="line">            services.AddVersionedApiExplorer(</span><br><span class="line">                options =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    // add the versioned api explorer, which also adds IApiVersionDescriptionProvider service</span><br><span class="line">                    // note: the specified format code will format the version as &quot;&#x27;v&#x27;major[.minor][-status]&quot;</span><br><span class="line">                    options.GroupNameFormat = &quot;&#x27;v&#x27;VVV&quot;;</span><br><span class="line">                    // note: this option is only necessary when versioning by url segment. the SubstitutionFormat</span><br><span class="line">                    // can also be used to control the format of the API version in route templates</span><br><span class="line">                    options.SubstituteApiVersionInUrl = true;</span><br><span class="line">                &#125;);</span><br><span class="line">            services.AddTransient&lt;IConfigureOptions&lt;SwaggerGenOptions&gt;, ConfigureSwaggerOptions&gt;();</span><br><span class="line">            services.AddSwaggerGen();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.</span><br><span class="line">        public void Configure(IApplicationBuilder app, IWebHostEnvironment env, IApiVersionDescriptionProvider provider)</span><br><span class="line">        &#123;</span><br><span class="line">            if (env.IsDevelopment())</span><br><span class="line">            &#123;</span><br><span class="line">                app.UseDeveloperExceptionPage();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            app.UseHttpsRedirection();</span><br><span class="line"></span><br><span class="line">            app.UseRouting();</span><br><span class="line"></span><br><span class="line">            app.UseAuthorization();</span><br><span class="line">            </span><br><span class="line">            // swagger 配置</span><br><span class="line">            app.UseSwagger();</span><br><span class="line">            app.UseSwaggerUI(</span><br><span class="line">                options =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    // build a swagger endpoint for each discovered API version</span><br><span class="line">                    foreach (var description in provider.ApiVersionDescriptions)</span><br><span class="line">                    &#123;</span><br><span class="line">                        options.SwaggerEndpoint($&quot;/swagger/&#123;description.GroupName&#125;/swagger.json&quot;, description.GroupName.ToUpperInvariant());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            app.UseEndpoints(endpoints =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                endpoints.MapControllers();</span><br><span class="line"></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>第48～60行:swagger 配置<br>第79～89行:swagger 配置</p>
<p>4.版本的類別撰寫:</p>
<p><strong>~/Controllers/V1_1/VersionController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections.Generic;</span><br><span class="line">using Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line">namespace TodoAPI.Controllers.V1_1</span><br><span class="line">&#123;</span><br><span class="line">    [ApiVersion(&quot;1.1&quot;)]</span><br><span class="line">    [Route(&quot;api/v&#123;version:apiVersion&#125;/[controller]&quot;)]</span><br><span class="line">    [ApiController]</span><br><span class="line">    public class VersionController : ControllerBase</span><br><span class="line">    &#123;</span><br><span class="line">        [HttpGet]</span><br><span class="line">        public IEnumerable&lt;string&gt; Get()</span><br><span class="line">        &#123;</span><br><span class="line">            return new string[] &#123; &quot;api v1.1&quot; &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>~/Controllers/V1_1/VersionController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections.Generic;</span><br><span class="line">using Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line">namespace TodoAPI.Controllers.V1_1</span><br><span class="line">&#123;</span><br><span class="line">    [ApiVersion(&quot;1.1&quot;)]</span><br><span class="line">    [Route(&quot;api/v&#123;version:apiVersion&#125;/[controller]&quot;)]</span><br><span class="line">    [ApiController]</span><br><span class="line">    public class VersionController : ControllerBase</span><br><span class="line">    &#123;</span><br><span class="line">        [HttpGet]</span><br><span class="line">        public IEnumerable&lt;string&gt; Get()</span><br><span class="line">        &#123;</span><br><span class="line">            return new string[] &#123; &quot;api v1.1&quot; &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>~/Controllers/V2_0/VersionController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections.Generic;</span><br><span class="line">using Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line">namespace TodoAPI.Controllers.V2_0</span><br><span class="line">&#123;</span><br><span class="line">    [ApiVersion(&quot;2.0&quot;)]</span><br><span class="line">    [Route(&quot;api/v&#123;version:apiVersion&#125;/[controller]&quot;)]</span><br><span class="line">    [ApiController]</span><br><span class="line">    public class VersionController : ControllerBase</span><br><span class="line">    &#123;</span><br><span class="line">        [HttpGet]</span><br><span class="line">        public IEnumerable&lt;string&gt; Get()</span><br><span class="line">        &#123;</span><br><span class="line">            return new string[] &#123; &quot;api v2.0&quot; &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>基本上就是改<br>第4行資料夾:V1_0 至 V1_1 至 V2_0<br>第6行ApiVersion:1.0 至 1.1 至 2.0<br>其他的Controller也是一樣，這邊就舉例VersionController.cs</p>
<p>5.啟用後範例:</p>
<img src="/2021/10/26/C-MVC-Web-API%E5%A2%9E%E5%8A%A0Swagger/demo.gif" class="">

<h3 id="專案連結"><a href="#專案連結" class="headerlink" title="專案連結"></a>專案連結</h3><p><a target="_blank" rel="noopener" href="https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI-Swagger">https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI-Swagger</a></p>
<h3 id="總覽"><a href="#總覽" class="headerlink" title="總覽"></a>總覽</h3><p>Swagger UI搭配版控，而在.net Core官方是沒有提供版本+Swagger配置的，所以踩很多雷。<br>這回參考了 <a target="_blank" rel="noopener" href="https://codingfreaks.de/dotnet-core-api-versioning/">https://codingfreaks.de/dotnet-core-api-versioning/</a> 的文章。<br>花了不少時間在除錯，最後終於把Swagger搭建起來。</p>
<p><strong>參考資料</strong><br><a target="_blank" rel="noopener" href="https://codingfreaks.de/dotnet-core-api-versioning/">https://codingfreaks.de/dotnet-core-api-versioning/</a><br><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-tw/aspnet/core/tutorials/getting-started-with-swashbuckle?view=aspnetcore-3.1&amp;tabs=visual-studio">https://docs.microsoft.com/zh-tw/aspnet/core/tutorials/getting-started-with-swashbuckle?view=aspnetcore-3.1&amp;tabs=visual-studio</a><br><a target="_blank" rel="noopener" href="https://medium.com/wenchin-rolls-around/%E8%BB%9F%E9%AB%94%E7%89%88%E6%9C%AC%E8%99%9F-ee446e1ad543">https://medium.com/wenchin-rolls-around/%E8%BB%9F%E9%AB%94%E7%89%88%E6%9C%AC%E8%99%9F-ee446e1ad543</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/26/C-MVC-Web-API%E5%A2%9E%E5%8A%A0Swagger/" data-id="cme6kwo0n001ggalj7ckk47m9" data-title="[Day23] C# MVC Web API版本增加Swagger - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C-MVC-API版本控制" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/19/C-MVC-API%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" class="article-date">
  <time class="dt-published" datetime="2021-10-19T11:59:32.000Z" itemprop="datePublished">2021-10-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Framework/AspNetCore-API/">AspNetCore API</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/19/C-MVC-API%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/">[Day22] C# MVC API版本控制 - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在上回中我們介紹了 <a href="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/" title="[Day21] C# MVC RESTful API (下) 實作RESTful API - C#&amp;AspNetCore">[Day21] C# MVC RESTful API (下) 實作RESTful API - C#&amp;AspNetCore</a> ，實作了RESTful API。</p>
<p>而這回將要進行API版本控制!<br>能處理前端(React/Vue)或APP(iOS/Android)不能馬上更新的最佳手段，有錯可以馬上先還原上一版本、達到向下相容。</p>
<h3 id="API規格"><a href="#API規格" class="headerlink" title="API規格"></a>API規格</h3><p>可修改apiVersion調用不同版本API，如:v1.0、v2.0</p>
<table>
<tbody><tr><th>方法</th>
<th>網址</th>
<th>描述</th>
<th>要求文本</th>
<th>回應文本</th>
</tr><tr>
<td>GET</td>
<td><code>&#123;apiVersion&#125;/api/todo</code></td>
<td>取得所有待辦事項</td>
<td>無</td>
<td>待辦事項陣列</td>
</tr>
<tr>
<td>GET</td>
<td><code>&#123;apiVersion&#125;/api/todo/&#123;id&#125;</code></td>
<td>依識別碼取得待辦事項</td>
<td>無</td>
<td>待辦事項</td>
</tr>
<tr>
<td>POST</td>
<td><code>&#123;apiVersion&#125;/api/todo</code></td>
<td>新增待辦事項</td>
<td>待辦事項</td>
<td>待辦事項</td>
</tr>
<tr>
<td>PUT</td>
<td><code>&#123;apiVersion&#125;/api/todo/&#123;id&#125;</code></td>
<td>更新現有的待辦事項</td>
<td>待辦事項</td>
<td>待辦事項</td>
</tr>
<tr>
<td>DELETE</td>
<td><code>&#123;apiVersion&#125;/api/todo/&#123;id&#125;</code></td>
<td>刪除待辦事項</td>
<td>無</td>
<td>待辦事項</td>
</tr>
<tr>
<td>GET</td>
<td><code>&#123;apiVersion&#125;/api/version</code></td>
<td>取得API版本</td>
<td>無</td>
<td>API版本</td>
</tr>
</tbody></table>


<h3 id="實作API版控"><a href="#實作API版控" class="headerlink" title="實作API版控"></a>實作API版控</h3><p>先列出我們要改的檔案隻數:</p>
<img src="/2021/10/19/C-MVC-API%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/2.png" class="">

<p>1.安裝Microsoft.AspNetCore.Mvc.Versioning</p>
<img src="/2021/10/19/C-MVC-API%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/1.png" class="">

<p>2.再來更新Startup.cs，服務增加一行啟用API功能services.AddApiVersioning()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// This method gets called by the runtime. Use this method to add services to the container.</span><br><span class="line">public void ConfigureServices(IServiceCollection services)</span><br><span class="line">&#123;</span><br><span class="line">    services.AddControllers();</span><br><span class="line">    // 資料庫配置</span><br><span class="line">    var connection = @&quot;Server=.\SQLExpress;Database=TodoDB;Trusted_Connection=True;ConnectRetryCount=0&quot;;</span><br><span class="line">    services.AddDbContext&lt;TodoDBContext&gt;(options =&gt; options.UseSqlServer(connection));</span><br><span class="line">    </span><br><span class="line">    // 啟用API版控功能</span><br><span class="line">    services.AddApiVersioning();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.以資料夾分版本層，就是把原本的Controller複製至版本資料夾</p>
<p>如1.0版:<br><strong>~/Controllers/V1/VersionController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections.Generic;</span><br><span class="line">using Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line">namespace TodoAPI.Controllers.V1</span><br><span class="line">&#123;</span><br><span class="line">    [ApiVersion(&quot;1.0&quot;)]</span><br><span class="line">    [Route(&quot;api/v&#123;version:apiVersion&#125;/[controller]&quot;)]</span><br><span class="line">    [ApiController]</span><br><span class="line">    public class VersionController : ControllerBase</span><br><span class="line">    &#123;</span><br><span class="line">        [HttpGet]</span><br><span class="line">        public IEnumerable&lt;string&gt; Get()</span><br><span class="line">        &#123;</span><br><span class="line">            return new string[] &#123; &quot;api v1&quot; &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如2.0版:</p>
<p><strong>~/Controllers/V2/VersionController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections.Generic;</span><br><span class="line">using Microsoft.AspNetCore.Mvc;</span><br><span class="line"></span><br><span class="line">namespace TodoAPI.Controllers.V2</span><br><span class="line">&#123;</span><br><span class="line">    [ApiVersion(&quot;2.0&quot;)]</span><br><span class="line">    [Route(&quot;api/v&#123;version:apiVersion&#125;/[controller]&quot;)]</span><br><span class="line">    [ApiController]</span><br><span class="line">    public class VersionController : ControllerBase</span><br><span class="line">    &#123;</span><br><span class="line">        [HttpGet]</span><br><span class="line">        public IEnumerable&lt;string&gt; Get()</span><br><span class="line">        &#123;</span><br><span class="line">            return new string[] &#123; &quot;api v2&quot; &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>只要在每個Controller修改以下的地方即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">namespace TodoAPI.Controllers.V1 </span><br></pre></td></tr></table></figure>
<p>改成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">namespace TodoAPI.Controllers.V2</span><br></pre></td></tr></table></figure>
<p>以及</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ApiVersion(&quot;1.0&quot;)]</span><br></pre></td></tr></table></figure>
<p>改成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ApiVersion(&quot;2.0&quot;)]</span><br></pre></td></tr></table></figure>
<p>TodoController.cs也是一樣喔，就不示範了。</p>
<p>4.嘗試看看</p>
<img src="/2021/10/19/C-MVC-API%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/demo.gif" class="">


<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>原本很難的事情，竟然可以如此簡單解決!感動!<br>再來就是考驗DB規劃了，因為如果要向下兼容變成只能增不能刪。<br>但通常我們能在上與下版間先除錯，所以基本上不會有太大問題。</p>
<p>而LINQ強型別好處就來了，因為是透過Model存取的關係，所以能夠有效避免規格錯誤。</p>
<p>而網址用v1.0、v2.0…原因在Get時瀏覽器只能用網址，所以是最方便的方式。<br>當然也能夠改放在header、或用?api=1.0的做法。</p>
<p>最後附上完整程式碼:<br><a target="_blank" rel="noopener" href="https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI-API-Version-Control">https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI-API-Version-Control</a></p>
<p>再來就是添加Swagger:<br> <a href="/2021/10/26/C-MVC-Web-API%E5%A2%9E%E5%8A%A0Swagger/" title="[Day23] C# MVC Web API版本增加Swagger - C#&amp;AspNetCore">[Day23] C# MVC Web API版本增加Swagger - C#&amp;AspNetCore</a></p>
<p>額外補充:<br>至於Controller多版本那Model呢?<br>因為向下兼容，可能會回傳不同版的Model<br>這時就可以使用繼承跟覆寫!<br>如1.1繼承1.0:ModelV1_1:ModelV1_0<br>之後添加屬性跟覆寫方法<br>而主要就是避免資料庫異動太大，就可以避免break change造成不相容。</p>
<p><strong>參考資料</strong><br><a target="_blank" rel="noopener" href="https://dotblogs.com.tw/rainmaker/2017/03/12/130759">https://dotblogs.com.tw/rainmaker/2017/03/12/130759</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/19/C-MVC-API%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" data-id="cme6kwo09000rgalj7kq5fv2s" data-title="[Day22] C# MVC API版本控制 - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C-MVC-RESTful-API-下-實作RESTful-API" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/" class="article-date">
  <time class="dt-published" datetime="2021-10-18T11:59:32.000Z" itemprop="datePublished">2021-10-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Framework/AspNetCore-API/">AspNetCore API</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/">[Day21] C# MVC RESTful API (下) 實作RESTful API - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在上回中我們介紹了 <a href="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/" title="[Day20] C# MVC RESTful API (中) 建立API專案 - C#&amp;AspNetCore">[Day20] C# MVC RESTful API (中) 建立API專案 - C#&amp;AspNetCore</a> ，我們在原本的MVC專案中加入了WEB API專案。</p>
<p>而這回將會撰寫RESTful API!<br>本文會以:<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-tw/aspnet/core/tutorials/first-web-api?view=aspnetcore-3.1&amp;tabs=visual-studio">https://docs.microsoft.com/zh-tw/aspnet/core/tutorials/first-web-api?view=aspnetcore-3.1&amp;tabs=visual-studio</a> 提供的範例作為實作依據。</p>
<h3 id="RESTful-API規格"><a href="#RESTful-API規格" class="headerlink" title="RESTful API規格"></a>RESTful API規格</h3><table>
<th>方法</th>
<th>網址</th>
<th>描述</th>
<th>要求文本</th>
<th>回應文本</th>
<tr>
<td>GET</td>
<td><code>/api/todo</code></td>
<td>取得所有待辦事項</td>
<td>無</td>
<td>待辦事項陣列</td>
</tr>
<tr>
<td>GET</td>
<td><code>/api/todo/&#123;id&#125;</code></td>
<td>依識別碼取得待辦事項</td>
<td>無</td>
<td>待辦事項</td>
</tr>
<tr>
<td>POST</td>
<td><code>/api/todo</code></td>
<td>新增待辦事項</td>
<td>待辦事項</td>
<td>待辦事項</td>
</tr>
<tr>
<td>PUT</td>
<td><code>/api/todo/&#123;id&#125;</code></td>
<td>更新現有的待辦事項</td>
<td>待辦事項</td>
<td>待辦事項</td>
</tr>
<tr>
<td>DELETE</td>
<td><code>/api/todo/&#123;id&#125;</code></td>
<td>刪除待辦事項</td>
<td>無</td>
<td>待辦事項</td>
</tr>
<!-- <tr>
<td>POST</td>
<td><code>/api/todo/batch</code></td>
<td>批次處理待辦事項，可批次新增、刪除、編輯</td>
<td>批次動作、待辦事項陣列</td>
<td>批次動作、待辦事項陣列</td>
</tr> -->
<tr>
</table>


<h3 id="實作RESTful-API"><a href="#實作RESTful-API" class="headerlink" title="實作RESTful API"></a>實作RESTful API</h3><p>先安裝基本資料庫套件<br>1.Microsoft.EntityFrameworkCore</p>
<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/1.png" class="">
<p>2.Microsoft.EntityFrameworkCore.SqlServer</p>
<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/2.png" class="">
<p>3.Microsoft.EntityFrameworkCore.Tools</p>
<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/3.png" class="">
<p>4.使用DB First</p>
<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/4.png" class="">

<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/5.png" class="">

<p>用<code>Scaffold-DbContext</code>指令，來還原TodoDB資料庫的Models</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Scaffold-DbContext &quot;Server=.\SQLExpress;Database=TodoDB;Trusted_Connection=True;&quot; Microsoft.EntityFrameworkCore.SqlServer -OutputDir Models</span><br></pre></td></tr></table></figure>
<p>執行畫面:</p>
<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/6.png" class="">
<p>執行後:</p>
<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/7.png" class="">

<p>5.Startup.cs增加資料庫配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// This method gets called by the runtime. Use this method to add services to the container.</span><br><span class="line">    public void ConfigureServices(IServiceCollection services)</span><br><span class="line">    &#123;</span><br><span class="line">        services.AddControllers();</span><br><span class="line">        // 資料庫配置</span><br><span class="line">        var connection = @&quot;Server=.\SQLExpress;Database=TodoDB;Trusted_Connection=True;ConnectRetryCount=0&quot;;</span><br><span class="line">        services.AddDbContext&lt;TodoDBContext&gt;(options =&gt; options.UseSqlServer(connection));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>6.撰寫RESTful API</p>
<p><strong>~/Controllers/TodoController.cs</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Threading.Tasks;</span><br><span class="line">using Microsoft.AspNetCore.Mvc;</span><br><span class="line">using Microsoft.EntityFrameworkCore;</span><br><span class="line">using TodoAPI.Models;</span><br><span class="line"></span><br><span class="line">namespace TodoAPI.Controllers</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    [Route(&quot;api/[controller]&quot;)]</span><br><span class="line">    [ApiController]</span><br><span class="line">    public class TodoController : ControllerBase</span><br><span class="line">    &#123;</span><br><span class="line">        private readonly TodoDBContext _context;</span><br><span class="line">        public TodoController(TodoDBContext context)</span><br><span class="line">        &#123;</span><br><span class="line">            _context = context;</span><br><span class="line">        &#125;</span><br><span class="line">        [HttpGet]</span><br><span class="line">        public async Task&lt;ActionResult&lt;IEnumerable&lt;Todo&gt;&gt;&gt; GetTodos()</span><br><span class="line">        &#123;</span><br><span class="line">            return await _context.Todos.Where(x=&gt;x.IsDeleted != 1).ToListAsync();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [HttpGet(&quot;&#123;id&#125;&quot;)]</span><br><span class="line">        public async Task&lt;ActionResult&lt;Todo&gt;&gt; GetTodo(int id)</span><br><span class="line">        &#123;</span><br><span class="line">            var obj = await _context.Todos.FindAsync(id);</span><br><span class="line"></span><br><span class="line">            if (obj.IsDeleted == 1)</span><br><span class="line">            &#123;</span><br><span class="line">                return NotFound();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            return obj;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [HttpPut(&quot;&#123;id&#125;&quot;)]</span><br><span class="line">        public async Task&lt;ActionResult&lt;Todo&gt;&gt; PutTodo(int id, Todo newObj)</span><br><span class="line">        &#123;</span><br><span class="line">            if (id != newObj.Id)</span><br><span class="line">            &#123;</span><br><span class="line">                return BadRequest();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            var obj = await _context.Todos.FindAsync(id);</span><br><span class="line"></span><br><span class="line">            if(obj.IsDeleted == 1)</span><br><span class="line">            &#123;</span><br><span class="line">                return NotFound();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            obj.IsComplete = newObj.IsComplete;</span><br><span class="line">            obj.Name = newObj.Name;</span><br><span class="line"></span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                await _context.SaveChangesAsync();</span><br><span class="line">            &#125;</span><br><span class="line">            catch (DbUpdateConcurrencyException)</span><br><span class="line">            &#123;</span><br><span class="line">                if (!TodoExists(id))</span><br><span class="line">                &#123;</span><br><span class="line">                    return NotFound();</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    throw;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            return obj;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [HttpPost]</span><br><span class="line">        public async Task&lt;ActionResult&lt;Todo&gt;&gt; PostTodo(Todo newObj)</span><br><span class="line">        &#123;</span><br><span class="line">            var obj = new Todo</span><br><span class="line">            &#123;</span><br><span class="line">                Name = newObj.Name,</span><br><span class="line">                IsComplete = 0,</span><br><span class="line">                IsDeleted = 0</span><br><span class="line">            &#125;;</span><br><span class="line">            _context.Todos.Add(obj); </span><br><span class="line">            await _context.SaveChangesAsync();</span><br><span class="line"></span><br><span class="line">            return CreatedAtAction(nameof(GetTodo), new &#123; id = obj.Id &#125;, obj);</span><br><span class="line">        &#125;</span><br><span class="line">        [HttpDelete(&quot;&#123;id&#125;&quot;)]</span><br><span class="line">        public async Task&lt;ActionResult&lt;Todo&gt;&gt; DeleteTodo(int id)</span><br><span class="line">        &#123;</span><br><span class="line">            var obj = await _context.Todos.FindAsync(id);</span><br><span class="line">            obj.IsDeleted = 1;</span><br><span class="line"></span><br><span class="line">            if (obj == null)</span><br><span class="line">            &#123;</span><br><span class="line">                return NotFound();</span><br><span class="line">            &#125;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                await _context.SaveChangesAsync();</span><br><span class="line">            &#125;</span><br><span class="line">            catch (DbUpdateConcurrencyException)</span><br><span class="line">            &#123;</span><br><span class="line">                if (!TodoExists(id))</span><br><span class="line">                &#123;</span><br><span class="line">                    return NotFound();</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    throw;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            return obj;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private bool TodoExists(int id)</span><br><span class="line">        &#123;</span><br><span class="line">            return _context.Todos.Any(e =&gt; e.Id == id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>7.用postman測試</p>
<img src="/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/demo.gif" class="">


<p>專案程式碼:<br><a target="_blank" rel="noopener" href="https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI">https://github.com/yuhsiang237/ASP.NET-Core-RESTfulAPI</a></p>
<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>這樣就完成了RESTful API了!</p>
<p><strong>參考資料</strong><br><a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-tw/aspnet/core/tutorials/first-web-api?view=aspnetcore-3.1&amp;tabs=visual-studio">https://docs.microsoft.com/zh-tw/aspnet/core/tutorials/first-web-api?view=aspnetcore-3.1&amp;tabs=visual-studio</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/18/C-MVC-RESTful-API-%E4%B8%8B-%E5%AF%A6%E4%BD%9CRESTful-API/" data-id="cme6kwo0l001dgalj34bk9aax" data-title="[Day21] C# MVC RESTful API (下) 實作RESTful API - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-C-MVC-RESTful-API-中-建立API專案" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/" class="article-date">
  <time class="dt-published" datetime="2021-10-17T02:16:48.000Z" itemprop="datePublished">2021-10-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Code/">Code</a>►<a class="article-category-link" href="/categories/Code/C/">C#</a>►<a class="article-category-link" href="/categories/Framework/">Framework</a>►<a class="article-category-link" href="/categories/Framework/AspNetCore-API/">AspNetCore API</a>►<a class="article-category-link" href="/categories/Topic/">Topic</a>►<a class="article-category-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/">[Day20] C# MVC RESTful API (中) 建立API專案 - C#&amp;AspNetCore</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>在上回中我們介紹了 <a href="/2021/10/16/C-MVC-RESTful-API-%E4%B8%8A-RESTful-%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98/" title="[Day19] C# MVC RESTful API (上) RESTful 基礎知識 - C#&amp;AspNetCore">[Day19] C# MVC RESTful API (上) RESTful 基礎知識 - C#&amp;AspNetCore</a> ，知道了RESTful API的基礎知識。</p>
<p>這回先了解如何在現有的MVC專案中加入API專案吧!</p>
<h3 id="MVC專案加入WEB-API專案"><a href="#MVC專案加入WEB-API專案" class="headerlink" title="MVC專案加入WEB API專案"></a>MVC專案加入WEB API專案</h3><p>1.這是一個原本的MVC專案</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/1.png" class="">
<p>2.對Solution點右鍵&gt;New Project</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/2.png" class="">
<p>3.選ASP.NET Core Web API</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/3.png" class="">
<p>4.建立API專案名稱，這取名TodoAPI</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/4.png" class="">
<p>5.版本我選.net core 3.1長期穩定版本</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/5.png" class="">
<p>6.這時就會有一個專案TodoAPI加入現有的Solution了。</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/6.png" class="">
<p>7.切換運行的專案</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/7.png" class="">
<p>8.執行，可出現預設的範例API結果</p>
<img src="/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/8.png" class="">

<h3 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h3><p>在這篇中主要是探討如何在一個有MVC專案的狀況下再去加一個Web API服務。<br>而在下篇我們就要用這範例實作RESTful API。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://yuhsiang237.github.io/2021/10/17/C-MVC-RESTful-API-%E4%B8%AD-%E5%BB%BA%E7%AB%8BAPI%E5%B0%88%E6%A1%88/" data-id="cme6kwo0m001fgalj2xc94n0m" data-title="[Day20] C# MVC RESTful API (中) 建立API專案 - C#&amp;AspNetCore" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/7/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/9/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Code/">Code</a><span class="category-list-count">79</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Code/C/">C#</a><span class="category-list-count">69</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Code/Javascript/">Javascript</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Code/Refactoring/">Refactoring</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Code/Typescript/">Typescript</a><span class="category-list-count">4</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Computer-Science/">Computer Science</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Computer-Science/Algorithm/">Algorithm</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Computer-Science/Data-structure/">Data structure</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Computer-Science/Electronic-Circuit/">Electronic Circuit</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Daily-Log/">Daily Log</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">57</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Database/PostgreSQL/">PostgreSQL</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/SQL-Server/">SQL Server</a><span class="category-list-count">47</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/">Framework</a><span class="category-list-count">27</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/AspNetCore-API/">AspNetCore API</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/AspNetCore-MVC/">AspNetCore MVC</a><span class="category-list-count">21</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/">Topic</a><span class="category-list-count">79</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/2021-C-AspNetCore-Challenge/">2021 C# AspNetCore Challenge</a><span class="category-list-count">30</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/2021-SQL-Server-Challenge/">2021 SQL Server Challenge</a><span class="category-list-count">30</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/2022-C-SyncAndAsync/">2022 C# SyncAndAsync</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/2025-Typescript/">2025 Typescript</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/Big-Data/">Big Data</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/LeetCode/">LeetCode</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Topic/SystemStructure/">SystemStructure</a><span class="category-list-count">1</span></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/08/">August 2025</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">May 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">March 2022</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">February 2022</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a><span class="archive-list-count">24</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a><span class="archive-list-count">46</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a><span class="archive-list-count">12</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 Yu Hsiang<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>